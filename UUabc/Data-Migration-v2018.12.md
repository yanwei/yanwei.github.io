# “UUabc->美国私塾”数据迁移方案

<link rel="stylesheet" type="text/css" href="https://yanwei.github.io/auto-number-title.css" />

<p align='right'>v1.0, Last Update: 2018.11.12</p>

## 定义

* **1.0系统**：2018年之前开发的旧系统，包括1v1手工排课和1v4手工排课。目前UUabc的1v1学员和少量需要手工排课（如试听、补课等）的学员在1.0系统上。
* **1.5系统**：2018.6月上线的系统，支持1v4车次和家长自助约课。目前约1500付费名学员在1.5系统上。
* **2.0系统**：即将于2018.12月上线的系统，基于美国私塾系统开发，支持四季切齐。首期开课时间为2019.1.21（寒假班）。预计学员数视销售情况而定。

## 目标

完成从1.0和1.5系统迁移学生和老师到2.0系统的工作，并确保在迁移过程中，学生和老师帐号/资料、学生课时、老师签约时间、选课计划、排课计划、薪资计算等各方面平稳过渡。

迁移方案需考虑同时支持上述3个版本系统稳定运行并进行顺利过渡。

## 原则

* 1.0系统中的1v1学员不在本次迁移考虑的范围内，但应考虑1v1和1v4老师在2.0系统中共用，以提高总体车位利用率，并降低外教管理难度。
* 1.5系统学员稳定过渡，不强制迁移到2.0系统。如截止2019.1.21，学员在1.5系统还有剩余课时，学员可以选择继续在1.5系统中学习，直到课时消耗完；也可选择补齐寒假班12课时（或寒春连报66课时、四季连报150课时）后，转到2.0系统学习。
* 从2.0系统排课以及满班率角度考虑，不否允许课时不足的学员迁移到2.0系统。
* 学员一旦从1.5系统迁移到2.0系统，则不允许再迁移回1.5系统。
* 从2018.12.1开始，所有新签学员必须进入2.0系统，同时1.5系统不再接收新签学员，但可以接收在读学员续费。
* 计划在2019.4.1-4.15期间，教材迁移到Reach，届时需考虑整个系统平滑升级，过渡到新的教材体系。

## 迁移涉及到的数据

* 学生数据
  * 帐号数据 / 学生资料
  * 账号资产
    * 直播课时：原则上不直接迁移到2.0系统，允许用户按一定比例转换成U币。
    * 1v1课时：原则上不可以迁移到2.0系统，用户可以选择在1.0平台消耗掉课时，或者按一定比例转换成U币。
    * 1v4课时：1.5系统学员迁移到2.0系统，如果除去四季切齐课程包后，还有多余课时，多余的课时按一定比例转换成U币。
    * U币数据：按1:1比例，直接转移到2.0系统。未来允许用U币兑换课程、商城礼品，或购课抵扣。
* 老师数据
  * 帐号数据 / 老师资料
  * 签约时间 / 车位信息

## 现有数据

### 学员数据（截止11.5数据）

* 1v1学员数：525
* 1v4学员数：约1600（有效人数），另有待合并帐号（小号）约500个
* 帐号合并后，有效学员总数不变，但是课时会增多，一方面1.21后还有课时的学员会增多，同时具备直接迁移到2.0系统条件的学员数也会增多。

### 老师数据（截止11.5数据）

* 1v1老师：76，总车位1615，周平均排课率58.2%
* 1v4老师：481，总车位7642，周平均排课率27.2%

### 1v4课时数据（截止11.5数据）

|剩余课时|<=20|21～31|32～85|86+|Total|
|---|---|---|---|---|---|
|学员总数|348|462|616|125|1551|
|可迁移到2.0寒假班|no|no*|yes|yes|741|
|可迁移到2.0春季班|no|no|no*|yes|125|
|预计可在1.21前结课|yes|no|no|no|348|

* 以上为截止目前，学员剩余课时分布情况。如1.21前学生续费，课时分布会发生改变。
* 以上可迁移数据只是按剩余课时估算的可能值。是否迁移到2.0系统的决定权在于家长，班主任只进行引导。
* 标注`no*`的表示有剩余课时，且可以在补齐课时后迁移。

### 1v4排课进度（截止11.5数据）

|ID|学员批次/车次|课程进度|预计结课时间|截止1.21剩余周数|学员数|
|---|---|---|---|---|---|
|1|零基础待开课|0/12|12.21～1.6|2周|30|
|2|7.30车次|28/48|12.21～1.6|2周|786|
|3|10.1车次（KA）|15/48|1.14～1.20|0周|99|
|4|6.25车次|32/48|12.3～12.9|6周|113|
|5|8.27车次|30/48|12.10～12.16|5周|173|
|6|10.29车次（下）|2/48||上到24课|254|
|7|7.23车次|46/48|11.5～11.11|10周|152|

* 如上表，4、5可合并；6、7可合并。
* 2.0系统寒假班从每个等级第一节课开始上，届时，当前所有车次的排课进度都不能无缝过渡，因此，学员如迁移到2.0系统，需选择当前等级从头开始上，或跳到下一等级。
* 随着1.5系统中的学员不断减少，班主任应尽量合并1.5系统中的车次，最终合并成每个等级1~2辆车，以最大化车位利用率，并降低运营难度。

## 迁移方案

基于以上数据，估算需要在1.0和1.5系统中保留多少老师，其他老师都可以迁移到2.0系统中去。

* 如果所有1.5系统学生都不迁移到2.0系统，在没有新增用户和续费的情况下，1.21之后，1.5系统中还有约1200学员；如考虑新增和续费，预估不超过1500人。
* 按每周排课2节，满班率50%，每位老师每周平均16个车位，车位利用率70%估算，需要约`1500 / (50% * 4) * 2 / 70% / 16 = 134`位老师。
* 考虑到实际情况下，1.5系统中会有部分学员迁移到2.0系统，因此，在1.5系统中保留`130～150`名老师是足够保险的策略（具体人数视实际学员转移的人数动态调整）。
* 加上1.0系统中1v1所需老师，共需在老系统中保留约`210~230`位老师。
* 所以，第一期可以迁移到2.0系统的老师数约为`340`位。
* 12.1之后所有新增老师直接进入2.0系统（延期开课时间至1.21），1.0和1.5系统中老师遵从缺一补一原则。

### 学生端

遵循最简原则，尽可能降低账号和资产迁移的复杂度。

```
结论1）多余课时冻结，用于兑换素质课包或续费抵扣
结论2）用户一旦转入2.0系统，不可转回1.5系统
```

* 1.20之前，只转移部分容易迁移的，尤其是课时少的。4月中有一次教材全面改版。大部分已有1v4学员，在那个时候再做评估决策，避免老学员两次被“升级”。
* 账户上没有四季切齐课程包的学员不可迁移。
* 老系统中的所有1v1和直播课时都不可迁移到2.0系统，只能在老系统中消耗。
* 所有主课课时消耗完后，按合同规定，赠送的直播课时都可做过期处理，无需迁移。
* 老系统中的1v4课时可以按补足原则，转换成对应的四季切齐课程包。如：用户账户剩余30个1v4课时，可以再购买36个课时（30 + 36 = 66），直接转成四季切齐寒春连报课程包。
* 因此，从老系统到2.0系统的迁移，只涉及四季切齐课程包和U币。
* 迁移过程必须在新老系统做好所有相关数据记录。
* 迁移完成后，用户登陆时将通过SSO直接进入2.0系统，无法再进入老系统。

|资产类型|处理/迁移方式|
|---|---|
|四季切齐课程包|直接迁移|
|U币|可按1:1比例迁移到2.0系统|
|1v1课时|可在1.0系统中继续消耗，不能迁移到2.0系统|
|1v4课时|可在1.5系统中继续消耗，不能直接迁移到2.0系统，补齐课时后可转换成四季切齐课程包|
|直播课时|不迁移|
|积分/等级|不迁移|
|钻石|不迁移|
|课时明细|不迁移|
|上课记录、作业和评语|不迁移|
|U币记录|不迁移|
|钻石记录|不迁移|
|请假记录|不迁移|
|推荐记录|不迁移|

* Case 1: 新签学生（不在1.5系统中开课），只有新四季切齐合同，直接迁移到2.0系统。
* Case 2: 学生有1v1和直播课时，只能在老系统中消耗，不可迁移。
* Case 3: 学生课时不足，补足后迁移到2.0系统，迁移后1.5系统没有剩余课时。
* Case 4: 学生课时足够，迁移到2.0系统后，课时依然有剩余（用户屯课太多），协商退费？

> 待确认：
> * 以上总体方案
> * 补齐课时续费&转换课程包方案（具体操作流程、价格等）
> * U币使用规则、退费规则等

### 老师端

* Phase 1: 12.1之前，决定哪些老师先期迁移到2.0系统，并同步老师资料过去。这个阶段只是给学生选课，老师实际上不需要进入2.0系统上课。但是可能需要进入新系统熟悉环境+培训等，需要考虑新旧系统帐号同步，允许老师同时登录两套系统。
* Phase 2: 1.21之前，所有新签约的老师，帐号和资料数据实时同步到2.0系统，老师无需在1.5系统中登录，直接进入2.0系统即可。
* Phase 3: 1.21之后，决定迁移的老师完全转到2.0系统上课，无需再登录1.5系统。
* 后续工作：考虑1.0/1.5系统中的老师如何和2.0系统老师合并共用。

|角色|2018.11|2018.12|2019.1|2019.2|
|---|---|---|---|---|
|1.0系统1v1老师|上传个人资料|-|-|-|
|1.0系统1v4老师|上传个人资料|-|-|-|
|1.5系统1v4老师|上传个人资料|-|-|-|
|从1.5系统迁移到2.0系统的老师|上传个人资料+1.5系统上课|2.0平台培训+1.5系统上课|2.0系统培训+2.0系统上课|2.0系统上课|
|12.1后新招聘的2.0系统老师|-|上传个人资料+2.0系统培训|2.0系统培训+2.0系统上课|2.0系统上课|

### 后台管理

* 12.1之前，老师招聘和管理相关工作仍需在1.0/1.5系统中进行，12.1～1.21期间完全合并到2.0系统（届时，除1v1学员服务外，1v4可完全放弃旧系统）。
* 采用新的薪资计算架构，从1.0、1.5、2.0系统获取老师出勤数据，对数据进行统一处理（ETL）后，交由BI系统计算薪资报表。
* 2.0系统教务、客服、技术支持、服务SOP等。

## 风险

* 新旧平台数据一致性
* 相当长的时间内，同时存在两套系统，对外教和内部员工带来困扰
* 新旧平台同时存在，增加运营工作量和难度

## 迁移步骤

## 时间表

|ID|事项|负责人|2018.11|2018.12|2019.1|2019.2|2019.3|
|---|---|---|---|---|---|---|---|
|10|合并整理1.5系统学员数据|Elva|待完成|||||
|20|确定需要迁移到2.0系统的学员名单|Elva|待完成|待完成|待完成|||
|21|确定补足课时销售政策和价格|Eason|待完成|
|30|收集外教资料并整理翻译|Hayley|完成现有老师资料|持续性工作|持续性工作|持续性工作|持续性工作|
|40|确定需要迁移到2.0系统的老师数量|Victor|待完成|||||
|50|确定需要迁移到2.0系统的老师名单|Hayley|待完成|||||
|60|同步老师资料到2.0系统|Beauli|待完成|持续性工作|持续性工作|持续性工作|持续性工作|
|70|迁移学员资料到2.0系统+学员补课时、新系统培训等|Elva|||待完成|||
|80|2.0系统相关功能内部培训|Victor|待完成|待完成||||
|90|2.0系统外教培训|Will|待完成|待完成|持续性工作|持续性工作|持续性工作|
|100|外教薪资数据整合和BI报表|Beauli||待完成||||
|110|2.0系统老师实际转移上课平台，关闭1.5系统入口|Victor|||待完成|||
|120|1.0/1.5/2.0系统老师完全合并共用|Beauli|||||待完成|
